{"version":3,"sources":["utils/string.ts","../node_modules/abnacn-validator/dist/abnacn-validator.js","components/organisms/TradingEntityPicker.tsx","components/organisms/AddTradingEntityDialog.tsx"],"names":["initials","value","split","map","parts","charAt","join","noSpaces","replace","define","exports","isValidABN","str","length","weights","checksum","Number","reduce","total","digit","index","isValidACN","acn","isNaN","parseInt","weighting","tally","i","check","isValidABNorACN","Object","defineProperty","Name","styled","span","EntityMatch","BusinessNumber","BusinessName","ListBoxStyles","css","TextFieldStyle","allTradingEntities","businessNumber","mainName","entityType","EntityType","Trust","entityId","businessNames","tradingCountry","Country","AU","Partnership","companyNumber","Company","filter","createFilterOptions","TradingEntityPicker","onChange","tradingJurisdiction","Autocomplete","autoHighlight","classes","listbox","options","getOptionSelected","option","renderOption","props","state","selectOnFocus","clearOnBlur","handleHomeEndKeys","getOptionLabel","inputValue","evt","newValue","None","filterOptions","params","filtered","cleanValue","push","formatBusinessNumber","renderInput","InputLabelProps","InputProps","rest","TextField","autoFocus","className","shrink","placeholder","ContentStyle","bp","xs","sm","SelectedEntityChipLabelStyle","AddTradingEntityDialog","isOpen","onClose","onSubmit","useState","selectedTradingEntity","setSelectedTradingEntity","theme","useTheme","fullScreen","useMediaQuery","breakpoints","down","reset","onModalClose","useEffect","Dialog","open","aria-labelledby","aria-describedby","DialogTitle","id","DialogContent","Grid","container","spacing","item","Chip","label","onDelete","DialogActions","Button","onClick","variant","disabled"],"mappings":"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","file":"static/js/33.e635e2ee.chunk.js","sourcesContent":["\nexport const initials = (value: string) =>\n  value.split(' ').map(parts => parts.charAt(0)).join('')\n\nexport const noSpaces = (value: string) =>\n  value.replace(/\\s/g, '')","(function (global, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(['exports'], factory);\n    } else if (typeof exports !== \"undefined\") {\n        factory(exports);\n    } else {\n        var mod = {\n            exports: {}\n        };\n        factory(mod.exports);\n        global.abnacn = mod.exports;\n    }\n})(this, function (exports) {\n    'use strict';\n\n    Object.defineProperty(exports, \"__esModule\", {\n        value: true\n    });\n    exports.isValidABN = isValidABN;\n    exports.isValidACN = isValidACN;\n    exports.isValidABNorACN = isValidABNorACN;\n    // Taken from Truffala's formula at:\n    // http://stackoverflow.com/questions/14174738/regex-to-match-australian-business-number-abn\n    function isValidABN(str) {\n        str = str.replace(/[ _]/g, '');\n\n        if (!str || str.length !== 11) {\n            return false;\n        }\n        var weights = [10, 1, 3, 5, 7, 9, 11, 13, 15, 17, 19],\n            checksum = str.split('').map(Number).reduce(function (total, digit, index) {\n            if (!index) {\n                digit--;\n            }\n            return total + digit * weights[index];\n        }, 0);\n\n        if (!checksum || checksum % 89 !== 0) {\n            return false;\n        }\n\n        return true;\n    }\n\n    // Taken from Worldspawn's post on http://forums.whirlpool.net.au/archive/984775\n    function isValidACN(acn) {\n        // Strip off white space\n        if (typeof acn === 'string') {\n            acn = acn.replace(/\\s/g, '').replace(/-/g, '');\n        }\n\n        if (acn.length != 9 || isNaN(parseInt(acn))) return false;\n\n        var weighting = [8, 7, 6, 5, 4, 3, 2, 1];\n        var tally = 0;\n        for (var i = 0; i < weighting.length; i++) {\n            tally += parseInt(acn.charAt(i)) * weighting[i];\n        }\n\n        var check = 10 - tally % 10;\n        check = check == 10 ? 0 : check;\n\n        return check == acn[8];\n    }\n\n    function isValidABNorACN(value) {\n        // Logical OR operation returns true if only of them is true, and false only if they're both false.\n        return isValidABN(value) || isValidACN(value);\n    }\n});\n","import { isValidABN } from 'abnacn-validator';\nimport { Autocomplete, createFilterOptions, TextField } from '@material-ui/core';\nimport styled from '@emotion/styled';\nimport { css } from 'emotion';\nimport React from 'react';\nimport TradingEntity from 'types/TradingEntity';\nimport EntityType from 'types/EntityType';\nimport { noSpaces } from 'utils/string';\nimport { formatBusinessNumber } from 'utils/businessIdentifier';\nimport { Country } from 'types/Country';\n\nconst Name = styled.span`\n  display: block !important;\n  font-size: 14px;\n`;\n\nconst EntityMatch = styled.span`\n  display: block;\n`;\n\nconst BusinessNumber = styled.span`\n  display: block;\n  font-size: 11px;\n  color: #666;\n  margin-top: 0.5em;\n`;\n\nconst BusinessName = styled.span`\n  display: block;\n  font-size: 11px;\n  color: #666;\n`;\n\nconst ListBoxStyles = css`\n  .MuiAutocomplete-option {\n    padding-top: 8px;\n    padding-bottom: 8px;\n  }\n`;\n\nconst TextFieldStyle = css`\n  .MuiFormLabel-root {\n    font-size: 11px;\n    color: #777;\n    /* text-transform: uppercase; */\n    line-height: 2em;\n  }\n  .MuiInput-root {\n    background-color: #eee;\n  }\n  .MuiInput-input {\n    padding: 6px 5px;\n    font-size: 14px;\n  }\n`;\n\nexport interface TradingEntityInput extends TradingEntity {\n  inputValue?: string;\n}\n\nconst allTradingEntities: TradingEntityInput[] = [\n  {\n    businessNumber: '34 826 428 290',\n    mainName: 'The Trustee for The A & A White Family Trust',\n    entityType: EntityType.Trust,\n    entityId: 'e1b05d24-2db8-451b-8812-9b38d2a26f93',\n    businessNames: [\n      'Advance Human Solutions',\n      'Empowering Woman',\n    ],\n    tradingCountry: Country.AU,\n  },\n  {\n    businessNumber: '63 316 911 021',\n    mainName: 'A SMITH & W SMITH & THE TRUSTEE FOR THE SMITH FAMILY TRUST',\n    entityType: EntityType.Partnership,\n    entityId: '31adab15-ca11-4a81-a619-5ab28811c902',\n    businessNames: [\n      'CE & H SMITH'\n    ],\n    tradingCountry: Country.AU,\n  },\n  {\n    businessNumber: '53 093 041 831',\n    companyNumber: '093 041 831',\n    mainName: 'THE RECRUITMENT COMPANY PTY. LIMITED',\n    entityType: EntityType.Company,\n    entityId: 'e1b05d24-ca11-451b-a619-5ab28811c902',\n    businessNames: [\n      'The Recruitment Company',\n      'The Services Company (TSC)',\n      'TRC PUBLIC SECTOR',\n      'TRC GROUP',\n      'TRC TECHNOLOGY'\n    ],\n    tradingCountry: Country.AU,\n  }\n];\n\nconst filter = createFilterOptions<TradingEntityInput>();\n\ninterface TradingEntityPickerProps {\n  value: TradingEntityInput | null;\n  tradingJurisdiction: Country;\n  onChange: (tradingEntity: TradingEntityInput | null) => void;\n}\n\nconst TradingEntityPicker = ({ value, onChange, tradingJurisdiction }: TradingEntityPickerProps) => {\n  return (\n    <Autocomplete\n      value={value}\n      autoHighlight\n      classes={{\n        listbox: ListBoxStyles\n      }}\n      options={allTradingEntities}\n      getOptionSelected={(option: TradingEntityInput, value: TradingEntityInput) => { \n        return value ? option === value : false;\n      }}\n      renderOption={(props, value, state) => (\n        <li {...props}>\n          <EntityMatch>\n            <Name>{value.mainName}</Name>\n            {!!value.businessNumber && <BusinessNumber>{value.businessNumber}</BusinessNumber>}\n            {!!value.businessNames && <BusinessName>{value.businessNames.join(', ')}</BusinessName>}\n          </EntityMatch>\n        </li>\n      )}\n      selectOnFocus\n      clearOnBlur\n      handleHomeEndKeys\n      getOptionLabel={(option) => {\n        // Value selected with enter, right from the input\n        if (typeof option === 'string') {\n          return option;\n        }\n        // Add \"xxx\" option created dynamically\n        if (option.inputValue) {\n          return option.inputValue;\n        }\n        // Regular option\n        return `${option.mainName} ${option.businessNumber.replace(/\\s/g, '')} ${option.businessNames?.join(' ')}`\n      }}\n      // getOptionLabel={(option) => `${option.name} ${option.email} ${option.mobile}`}\n      // value={value}\n      // value={selectedValueWithLabel}\n      // onChange={(evt, newValue) => onChange(newValue)}\n      onChange={(evt, newValue) => {\n        if (typeof newValue === 'string') {\n          onChange({\n            businessNumber: '',\n            entityType: EntityType.None,\n            mainName: newValue,\n            tradingCountry: Country.None // TODO: Fix\n            // email: newValue,\n          });\n        } else if (newValue) {\n          // Create a new value from the user input\n          onChange(newValue);\n        } else {\n          onChange(null);\n        }\n      }}\n      filterOptions={(options, params) => {\n        const filtered = filter(options, params);\n        const cleanValue = noSpaces(params.inputValue);\n\n        // Suggest the creation of a new value\n        if (cleanValue !== '') {\n          if (tradingJurisdiction === Country.AU) {\n            if (cleanValue.length === 11 && isValidABN(cleanValue)) {\n              filtered.push({\n                inputValue: cleanValue,\n                businessNumber: '',\n                entityType: EntityType.None,\n                mainName: `Lookup \"${formatBusinessNumber(cleanValue, tradingJurisdiction)}\" on ABR Search`,\n                tradingCountry: tradingJurisdiction,\n              });\n            }\n          } else {\n            filtered.push({\n              inputValue: cleanValue,\n              businessNumber: '',\n              entityType: EntityType.None,\n              mainName: `Lookup \"${formatBusinessNumber(cleanValue, tradingJurisdiction)}\"`,\n              tradingCountry: tradingJurisdiction,\n            });\n          }\n        // } else {\n        //   filtered.push({\n        //     // inputValue: params.inputValue,\n        //     id: 0,\n        //     name: '',\n        //     email: 'Type email address to Add'\n        //   });\n        // }\n        }\n\n        return filtered;\n      }}\n      // onBlur={onBlur}\n      // freeSolo\n      renderInput={({ InputLabelProps, InputProps, ...rest }) => \n        <TextField\n          autoFocus={true}\n          className={TextFieldStyle}\n          // label=\"Find or create user\"\n          // error={!!error}\n          InputLabelProps={{ shrink: true, ...InputLabelProps }}\n          InputProps={{ placeholder: 'Find by business number or name', ...InputProps }}\n          // helperText={ error?.message ?? '' }\n          {...rest}\n        />\n      }\n    />\n  )\n};\n\nexport default TradingEntityPicker;\n","import { Button, Chip, Dialog, DialogActions, DialogContent, DialogTitle, Grid, useMediaQuery, useTheme } from '@material-ui/core';\nimport { css } from 'emotion';\nimport React, { useEffect } from 'react';\nimport { useState } from 'react';\nimport { bp } from 'theme';\nimport { Country } from 'types/Country';\nimport TradingEntityPicker, { TradingEntityInput } from './TradingEntityPicker';\n\nconst ContentStyle = css`\n  ${bp.xs} {\n    width: 100%\n  }\n  ${bp.sm} {\n    width: 580px;\n  }\n`\n\nconst SelectedEntityChipLabelStyle = css`\n  font-size: 14px;\n  ${bp.xs} {\n    max-width: 340px;\n  }\n  ${bp.sm} {\n    max-width: 500px;\n  }\n`\n\nexport interface AddTradingEntityDialogProps {\n  isOpen: boolean;\n  tradingJurisdiction: Country;\n  // tradingEntity?: TradingEntityInput;\n  onClose: () => void;\n  onSubmit: (tradingEntity: TradingEntityInput) => void;\n}\n\nfunction AddTradingEntityDialog({ isOpen, onClose, onSubmit, tradingJurisdiction }: AddTradingEntityDialogProps) {\n  const [selectedTradingEntity, setSelectedTradingEntity] = useState<TradingEntityInput | null>(null);\n  const theme = useTheme();\n  const fullScreen = useMediaQuery(theme.breakpoints.down('xlMob'))\n\n  useEffect(\n    () => {\n      // Unmount CallBack\n      if (!isOpen) {\n        reset();\n      }\n      return () => reset();\n    },\n    [isOpen]\n  )\n\n  function reset() {\n    setSelectedTradingEntity(null);\n  }\n\n  function onModalClose() {\n    onClose();\n  }\n\n  function onModalOK() {\n    onSubmit(selectedTradingEntity!);\n  }\n\n  function onSelectionRemove() {\n    setSelectedTradingEntity(null);\n  }\n\n  return (\n    <Dialog\n      fullScreen={fullScreen}\n      open={isOpen}\n      onClose={onModalClose}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">\n        Find Trading Entity\n      </DialogTitle>\n      <DialogContent className={ContentStyle}>\n        <Grid container spacing={2}>\n          <Grid item xs={12}>\n          {\n              (selectedTradingEntity) ?\n              <Chip\n                classes={{ label: SelectedEntityChipLabelStyle }}\n                label={selectedTradingEntity.inputValue ? selectedTradingEntity.inputValue : `${selectedTradingEntity.mainName} (${selectedTradingEntity.businessNumber})`}\n                onDelete={onSelectionRemove}\n              />\n              :\n              <TradingEntityPicker\n                tradingJurisdiction={tradingJurisdiction}\n                value={selectedTradingEntity}\n                onChange={setSelectedTradingEntity}\n              />\n            }\n            {/* <TextField\n              name=\"BusinessNumber\"\n              control={control}\n              // label=\"Name\"\n              placeholder=\"Search by Business Number\"\n              // rules={ { required: 'Required' } }\n            /> */}\n          </Grid>\n        </Grid>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onModalClose}>\n          Cancel\n        </Button>\n        <Button variant=\"contained\" disabled={!selectedTradingEntity} onClick={onModalOK}>\n          Select\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default AddTradingEntityDialog;\n"],"sourceRoot":""}